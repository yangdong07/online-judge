

## Distributing Balls into Boxes

把一个大象放一个冰箱。。。咳咳，是把若干球放在若干盒子里，有多少种方法？

参考 http://www.careerbless.com/aptitude/qa/permutations_combinations_imp7.php

这是排列组合中最常见的一类问题。为了避免每次都重复思考这个问题，这里总结一下。

每种问题对应着一种搜索树。

| $m$ 个球 | $n$ 个盒子 | 无限制 | 每个盒子至多1个球 | 每个盒子至少一个球 | 每个盒子只有一个球 |
| -- | -- | -- | -- | -- |-- |
| 不同 | 不同 | $n^m$ | $P_n^m$ | $S(m, n)$ | $n!$ |
| 相同 | 不同 | |

#### $m$ 个不同的球，放在 $n$ 个不同的盒子中，共有多少种方法？

每个球有 $n$ 个选择，因为都是不同的，并且也是独立的(independent)，根据乘法原理，有 $n^m$ 种方法。

搜索树：这是一个满完全 $n$ 树（Perfect Tree），所以搜索的时候每个节点有 $n$ 个分支，有 $m$ 层。

第一层决定第一个球；第二层决定第二个球； 这还是回溯式的写法：每个状态都是临时的。

#### $m$ 个不同的球，放在 $n$ 个不同的盒子中，每个盒子至多一个球，共有多少种方法？

这是简单的排列问题。这里有个隐含的条件是 $m \leq n$。 

第一个球有 $n$ 种选择，第二个球有 $n - 1$ 种选择， 第 $m$ 个球有 $n - m + 1$ 个选择。因此总共是 $P_n^m$ 种方法。

搜索树：这是一个可以产生排列的数据结构，在每一层可用的分支数减一。一种自然的方式使用一个 `used` 数组来保存使用状态。会有额外的消耗（遍历数组产生的消耗），但总的时间复杂度是 $O(n*n!)$，这多出来的 $n$ 实际上是遍历 `used` 数组产生的消耗。也可以用 `set` 这样的数据结构。

#### $m$ 个不同的球，放在 $n$ 个不同的盒子里，每个盒子至少一个球，共有多少种方法？

$S(m,n)$，Stirling number of the second kind

$$S(m, n) = \frac{1}{n!} \sum_{i=0}^{n-1}{(-1)^in_{C_i}(n - i)^m}$$

Special Cases
- $S(0,0) = 1$
- $S(m,0) = 0$ for $m \geq 1$
- $S(m,n) = 0$ for $m < n$

这个公式好复杂。 $n_{C_i}$ 是什么意思？

树结构：


#### $m$ 个不同的球，放在 $n$ 个不同的盒子里，每个盒子正好一个球，共有多少种方法？

这个隐含条件 $m = n$， 有 $n!$ 种方法，这个就是全排列。

#### $m$ 个相同的球，放在 $n$ 个不同的盒子里，共有多少种方法？

这个问题可以变成，在 $m$ 个相同的球之间插入 $n - 1$ 个隔板，分成 $n$ 堆，总共有多少种方法。