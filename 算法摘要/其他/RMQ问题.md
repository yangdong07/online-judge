

### RMQ问题

Range Minimum Query

在一个范围内查询这个范围内的最小值或最大值。 要求 $O(1)$


#### 原始暴力方法

在范围内做线性查找，时间复杂度为 $O(n)$

预处理时间为 $O(1)$


#### Sparse Table



在图论里，稀疏的定义： 边的个数与点的个数差不多。

`st[i][j]` 表示 $i$ 位置开始的 $2^j$ 个数中的最大值。

- `st[i][0]` 即 $i$ 位置的数。
- `st[i][1]` 即 `i` 和 `i + 1` 2个数的最大值

可以用 二分观察 DP的规律：

$$ st[i][j] = \max{(st[i][j - 1], st[i + 2^{j - 1}][j - 1])}$$

预处理时间是：  $O(n\log n)$

查询处理的方式： 给定 `[l, r]`，找两个区间覆盖整个区间就可以了：

- `[l, l + 2^k - 1]`， 即 `st[l][k]`
- `[r - 2^k + 1, r]`， 即 `st[r - 2^k + 1][k]`

要求： $l + 2^k - 1 \leq r$， 即 $k \leq \log{(r - l + 1)}$

计算 $k = \log{(r - l + 1)}$， 向下取整。

很大常数项的 $O(1)$，因为要计算 log 。log 也可以预处理。
