
### P1340 兽径管理

算法标签: **图论**, **排序**, **插入排序**, **生成树**
其他标签: **福建省历届夏令营**, **高性能**

#### Description


#### Analysis

这一题历时5个小时。主要这5个小时中乱七八糟的事情干扰太多，没法专心做题。

> RDF一姓吴的教物理的就是个傻逼，果然是没了爹的人，缺教养。 -- 题记

这题不是一下给出一张全图， 而是“每周”添加一条边， 每次都问一个最小生成树的权和。

一种直接思路是 每次都重算一遍 最小生成树。 总的时间复杂度为 $O(E^2 \log E)$， 由于 $E$ 比较大， 在 6000 这个量级，并且常数因子也比较大， 所以毫无疑问的 TLE了。

每次用 Kruskal 算最小生成树的时候，都要排一次序。但是新加入的边，其实只需要插入到一个已经排过序的边集就可以了，这样会减轻一些工作量，但是排序时间仍然是 $O(E)$ 的。所以写了一个插入排序版本的 Kruskal， TLE 的点都过了。但是时间上仍然并不理想。20个测试点加一起有 4000多ms。

还有一种思路是逆向思维：先记录图完成时候的最小生成树，然后从最后一条边开始移除。如果这条边在已知的最小生成树中，那就重做一次 Kruskal。一开始我对这个索引感到十分棘手，既要按权重边集排序，又要保证可以按编号顺序移除边集。

后来发现，其实连排序都可以省掉。对全边集进行一次排序，做一次Kruskal。以后用两个标记数组分别表示 移除状态和是否在 MST 的状态。 

这种在一定程度上避免了 $O(E)$ 次 Kruskal 算法。 但是有最坏情况： 某条边的权值不断下降，也就是说，每次都需要重新选择加入这条边。












#### [Code](../../cpp/13/p1340.cpp)


