### P1541 乌龟棋

算法标签: **动态规划,动规,dp**, **枚举,暴力**, **递归**
其他标签: **NOIp提高组**, **2010**


#### Description

#### Analysis

这题其实很简单：递归求解，记忆化搜索是非常直接的思路。

比如我想知道  $a, b, c, d$ 四种卡牌最后能得到最大多少分？ 即求 $f(a, b, c, d)$

包括以下几种情况

- $f(a - 1, b, c, d)$ 上一次用了1步卡牌
- $f(a, b - 1, c, d)$ 上一次用了2步卡牌
- $f(a, b, c - 1, d)$ 上一次用了3步卡牌
- $f(a, b, c, d - 1)$ 上一次用了4步卡牌

递归的次数有 $4^{a + b + c + d}$次， 实际解的个数只有  $(a + 1)(b + 1)(c + 1)(d + 1)$。 在搜索过程中可能会出现重复情况，用记忆化搜索就可以了。

实际上，记忆化搜索就是 动态规划自下向上构建解的反向过程： 自上而下找到解。

然后考虑优化。实际的动态方程是：

$$dp(a,b,c,d) = g(step) + \max \left\{ \begin{array}{r}

dp(a - 1, b, c, d) \\
dp(a, b - 1, c, d) \\
dp(a, b, c - 1, d) \\
dp(a, b, c, d - 1) \\

\end{array}\right.$$

$dp(a, b, c, d)$ 表示用掉 $a, b, c, d$ 四张卡牌最大可以得到多少分。隐含了一个状态 步数 $step = 1 + a + 2b + 3c + 4d$

状态上无法再进行优化，但是可以进行空间优化： 压缩一维状态。

还是观察状态方程： 想象一个三维空间（四维的想不出来）， 每一层表示 $a$ 的状态空间； 那么 $dp(a, b, c, d)$ 实际依赖它 **上一层** 的点 $dp(a - 1, b, c, d)$， 和它 **同层** 之前的点 $dp(a, b - 1, c, d)$ 等。

所以可以把 $a$ 这一维状态给干掉。 压缩成三维 DP状态空间。 但是循环还是在四维上做。

#### [Code](../cpp/p1541.cpp) 

