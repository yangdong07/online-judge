### P1403 [AHOI2005]约数研究

算法标签: **数论,数学**, **枚举,暴力**, **概率论,统计**
其他标签: **福建省历届夏令营**


#### Description

#### Analysis

哇，如此水题。

题目大意，求出 `[1, n]` 范围内所有数的约数的个数。

- 约数有1的，有 `n / 1` 个
- 约数有2的，有 `n / 2` 个
- 约数有k 的，有 `n / k` 个

所以有 $O(N)$ 的时间可以算出来所有个数。 对这题来说足够了。

但是有更好的办法： 有 $O(\sqrt{N})$ 的， 还有 $O(n^{1/3} \log n)$ 的，懒得研究了。

#### Optimize

好吧，更好的办法来了。

有很多 $\lfloor n / i \rfloor$ 是一样的， 例如 $100/21 = 4, 100 / 22 = 4, 100/23 = 4, 100/ 24 = 4$

现在思考这个问题： 为什么一样？ 考虑 $n = ik + x$ ，其中 `k = n / i`， `x = n % i`， 都是非负整数。

想象一个长度 100 按照 21 长度可以分成4段。 那么按照 22长度呢？ 每一段增加1。 没关系，有富余的 `100 - 21 * 4 = 16`。 足够每一段增加4个单位：变成 按照25 长度分成4段。 所以其实 $i$ 增加 $\lfloor x / k \rfloor$ 都不会变化。

所以可以写成：

```cpp
int main()
{
    int n;
    cin >> n;

    int sum = 0, i, j;
    for (i = 1; i <= n; i += j)
    {
        j = (n % i) / (n / i) + 1;
        sum += (n / i) * j;
    }
    cout << sum;
    return 0;
}
```

接下来看简化的式子： `n / (n / i) = (i * k + x) / (n / i) = i + (n % i) / (n / i)`

所以就有了题解中的这样的写法：

```cpp
int main()
{
    int n;
    cin >> n;

    int sum = 0, i, j;
    for (i = 1; i <= n; i = j + 1)
    {
        j = n / (n / i);
        sum += (n / i) * (j - i + 1);
    }
    cout << sum;
    return 0;
}
```

#### [Code](../cpp/p1403.cpp) 

